class Cart{constructor(t,a=".Busketonjs",s=".Busket"){this.source=t,this.container=a,this.containerMini=s,this.countGoods=0,this.amount=0,this.cartItems=[],this.flagTotal=!1,this._init(this.source)}_render(){let t=$("<div/>",{class:"ProdectionDetailsHeader"}),a=$("<span/>",{class:"PDHeader",text:"Product Details"}),s=$("<span/>",{class:"PDHeader",text:"unite Price"}),e=$("<span/>",{class:"PDHeader",text:"Quantity"}),i=$("<span/>",{class:"PDHeader",text:"shipping"}),o=$("<span/>",{class:"PDHeader",text:"Subtotal"}),n=$("<span/>",{class:"PDHeader",text:"ACTION"});t.appendTo($(this.container)),a.appendTo($(t)),s.appendTo($(t)),e.appendTo($(t)),i.appendTo($(t)),o.appendTo($(t)),n.appendTo($(t))}_renderMini(){let t=$("<div/>",{class:"mega-flex-myaccount-busket total"}),a=$("<div/>",{class:"Totalprice"}),s=$("<form/>",{class:"Totalform",action:"checkout.html"});t.appendTo($(this.containerMini)),a.appendTo($(t)),a.append($('<span class="Total">TOTAL</span>')),a.append($(`<span class="Price" id="basket-price">$${this.amount}</span>`)),s.appendTo($(t)),s.append($('<button class="ButtonCheckout">Checkout</button>')),t.append($('<button class="ButtonGotocart">Go&nbsp;to&nbsp;cart</button>')),$("#basket-count").text(this.countGoods)}_clearTotalMini(){$(".Totalprice").detach(),$(".Totalform").detach(),$(".ButtonCheckout").detach(),$(".ButtonGotocart").detach(),$(".total").detach()}_init(t){if(this._render(),localStorage.getItem("mycart")){this.cartItems=JSON.parse(localStorage.getItem("mycart"));for(let t of this.cartItems)this._renderItem(t),this._renderItemMini(t);this.amount=JSON.parse(localStorage.getItem("amount")),this.countGoods=JSON.parse(localStorage.getItem("countGoods")),this.flagTotal||this._renderMini(),this._renderSum()}else fetch(t).then(t=>t.json()).then(t=>{for(let a of t.contents)this.cartItems.push(a),this._renderItem(a),this._renderItemMini(a);this.countGoods=t.countGoods,this.amount=t.amount,this.flagTotal||this._renderMini(),this._renderSum(),this._renderSumMini(),localStorage.setItem("mycart",JSON.stringify(this.cartItems)),localStorage.setItem("amount",JSON.stringify(this.amount)),localStorage.setItem("countGoods",JSON.stringify(this.countGoods))})}_renderItem(t){let a=$("<div/>",{class:"ProductinBusket","data-product":t.id_product}),s=$("<div/>",{class:"ProductUnitinBusket"}),e=$("<div/>",{class:"MyAccountBusketNames"}),i=$("<div/>",{class:"Color"}),o=$("<div/>",{class:"Size"}),n=$("<div/>",{class:"ProductUnitClose"});a.appendTo($(this.container)),s.appendTo($(a)),s.append($(`<img class="MyaccountImg" src=${t.src} alt=${t.alt}>`)),e.appendTo($(s)),e.append($(`<a class="BusketName" href="singlepage.html">${t.product_name}</a>`)),i.appendTo($(e)),i.append($('<span class="colorHD">Color:</span>')),i.append($(`<span class="colortxt">${t.color}</span>`)),o.appendTo($(e)),o.append($('<span class="SizeHD">Size:</span>')),o.append($(`<span class="Sizetxt">${t.size}</span>`)),a.append($(`<span class="ProductUnitPrice">$${t.price}</span>`)),a.append($(`<input class="ProductUnitKol" type="number" name="number" value="${t.quantity}" data-product="${t.id_product}">`)),a.append($('<span class="ProductSheepPrice">FREE</span>')),a.append($(`<span class="ProductUnitST">$${+t.price*+t.quantity}</span>`)),n.appendTo($(a)),n.append($(`<a href="#"><img class="CloseImg" src="img/closeButton.png" alt="stars" data-product="${t.id_product}"></a>`))}_renderItemMini(t){let a=$("<div/>",{class:"mega-flex-myaccount-busket","data-product":t.id_product}),s=$("<div/>",{class:"MyaccountBusket","data-product":t.id_product}),e=$("<div/>",{class:"MyAccountBusketNames"}),i=$("<div/>",{class:"Number_Price"});$("<div/>",{class:"Totalprice"});a.appendTo($(this.containerMini)),s.appendTo($(a)),s.append($(`<img class="MyaccountImg" src=${t.src} alt=${t.alt}>`)),e.appendTo($(s)),e.append($(`<span class="BusketName">${t.product_name}</span>`)),e.append($('<img class="StarsImg" src="img/stars-5.png" alt="stars">')),i.appendTo($(e)),i.append($(`<span class="number">${t.quantity}&nbsp;x </span>`)),i.append($(`<span class="price">$${t.price}</span>`)),s.append($(`<img class="CloseImg" src="img/closeButton.png" alt="stars" data-product="${t.id_product}">`)),$("#basket-count").text(this.countGoods)}_renderSum(){$(".SubtotalPrice").text(`$${this.amount}`),$(".GrandtotalPrice").text(`$${this.amount}`)}_renderSumMini(){$("#basket-price").text(`$${this.amount}`)}_updateCart(t){let a=$(`[data-product=${t.id_product}]`);a.find(".ProductUnitKol").val(t.quantity),a.find(".ProductUnitST").text(`$${+t.price*+t.quantity}`)}_updateCartmini(t){$(`[data-product=${t.id_product}]`).find(".number").text(`${t.quantity} x `),$("#basket-count").text(this.countGoods)}addProduct(t){let a=+$(t).data("id"),s=this.cartItems.find(t=>t.id_product===a);if(s)s.quantity++,this.countGoods++,this.amount+=s.price,this._updateCart(s),this._updateCartmini(s);else{let s={id_product:a,product_name:$(t).data("name"),price:+$(t).data("price"),src:$(t).data("src"),alt:$(t).data("alt"),color:"Red",size:"XXL",quantity:1};this.cartItems.push(s),console.log(this.cartItems),this.amount+=s.price,this.countGoods+=s.quantity,this._renderItemMini(s),this._clearTotalMini(),this.flagTotal=!0,this._renderMini()}localStorage.setItem("mycart",JSON.stringify(this.cartItems)),localStorage.setItem("amount",JSON.stringify(this.amount)),localStorage.setItem("countGoods",JSON.stringify(this.countGoods)),this._renderSumMini()}remove(t){let a=+t,s=this.cartItems.find(t=>t.id_product===a);s.quantity>1?(s.quantity--,this.countGoods--,this._updateCartmini(s),this._updateCart(s)):(this.cartItems.splice($.inArray(s,this.cartItems),1),$(`[data-product=${a}]`).remove(),this.countGoods--,$("#basket-count").text(this.countGoods)),this.amount-=s.price,localStorage.setItem("mycart",JSON.stringify(this.cartItems)),localStorage.setItem("amount",JSON.stringify(this.amount)),localStorage.setItem("countGoods",JSON.stringify(this.countGoods)),this._renderSumMini(),this._renderSum()}change(t){let a=+t,s=this.cartItems.find(t=>t.id_product===a),e=$(`[data-product=${s.id_product}]`),i=+e.find(".ProductUnitKol").val();i<s.quantity?(s.quantity>1?(s.quantity--,this.countGoods--,this._updateCartmini(s),this._updateCart(s)):(this.cartItems.splice($.inArray(s,this.cartItems),1),$(`[data-product=${a}]`).remove(),this.countGoods--,$("#basket-count").text(this.countGoods)),this.amount-=s.price):(s.quantity++,this.countGoods++,this.amount+=s.price,this._updateCartmini(s),e.find(".ProductUnitST").text(`$${+s.price*i}`)),localStorage.setItem("mycart",JSON.stringify(this.cartItems)),localStorage.setItem("amount",JSON.stringify(this.amount)),localStorage.setItem("countGoods",JSON.stringify(this.countGoods)),this._renderSumMini(),this._renderSum()}}